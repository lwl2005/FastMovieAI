import{_ as cl}from"./index-BBg_jDok.js";import{_ as pl,c as _l}from"./xl-actor-create-RqUOliv0.js";import{d as ml,Y as fl,r as d,z as we,w as gl,o as vl,a as hl,j as V,k as u,l as n,e as _,f as ee,m as t,s,an as xl,B as kl,u as o,q as yl,L as bl,h as i,I as g,M as z,N as wl,af as D,am as Cl,p as le,a8 as Sl,x as ae,t as C,aq as Vl,ar as zl,C as El,a5 as Il,ac as Ul,as as oe,ai as Rl,a6 as Al,J as Ll,S as $l,E as f,al as Fl}from"./vendor-C6C8mA7k.js";import{u as Ce,I as Se,_ as Pl}from"./usePoints-DiZlsgf1.js";import{c as Bl,u as Ve,a as Dl,$ as x,R as S,r as ze,_ as Ml}from"./index-BY2sLTz-.js";import{I as Gl}from"./icon-prev-step-BXDsHHJ2.js";import{I as ql}from"./icon-next-step-dF3w-4aj.js";import{I as Nl}from"./icon-batch-DD0Cm_Jc.js";import{I as Ee}from"./icon-points-DqG7XnbB.js";import{I as Tl}from"./icon-replace-D95gtLmn.js";import{u as Ol}from"./usePush-CTrtsatV.js";import"./icon-image-ide2QEnO.js";const Wl={class:"flex flex-column draw-module"},jl={class:"flex-1 flex grid-gap-10 overflow-hidden"},Hl={class:"flex-1 flex flex-column grid-gap-4 overflow-hidden"},Jl={class:"grid-columns-xxl-7 grid-columns-xl-6 grid-columns-lg-5 grid-columns-md-4 grid-columns-sm-3 grid-columns-xs-2 grid-columns-p-1 grid-gap-4"},Yl=["onClick"],Kl=["onClick"],Ql={class:"flex grid-gap-2 actor-status"},Xl={class:"flex flex-column flex-y-flex-end grid-gap-2"},Zl={class:"flex flex-column grid-gap-2 actor-info"},ea=["onClick"],la={class:"actor-action flex flex-center px-4"},aa={key:0},oa={key:1},ta={key:0},sa={key:1},na={key:2},ra={class:"actor-form-wrapper bg-overlay border rounded-4 actor-form flex flex-column grid-gap-4"},ia={class:"border-bottom flex flex-center"},da={class:"flex flex-column grid-gap-2 px-4"},ua={class:"flex grid-gap-2"},ca={class:"flex flex-column grid-gap-2 px-4"},pa={class:"bg rounded-4 p-4 border"},_a={class:"flex flex-y-center grid-gap-2"},ma={class:"h10 text-ellipsis-1",style:{"max-width":"60px"}},fa={class:"h10 text-ellipsis-1",style:{"max-width":"60px"}},ga={class:"bg-overlay rounded-round p-3 flex flex-center grid-gap-2 pointer hover-bg-hover"},va={class:"flex flex-center grid-gap-2"},ha={class:"h10"},xa={key:0,class:"grid-columns-2 grid-gap-4 p-4"},ka=["onClick"],ya={class:"p-4 w-100 flex grid-gap-4 flex-center"},ba={class:"flex grid-gap-10"},wa={class:"flex flex-center grid-gap-2"},Ca={class:"h10"},Sa=ml({__name:"index",emits:["update:drama"],setup(Va,{emit:Ie}){const U=fl(),Ue=Bl(),{USERINFO:te}=Ve(Ue),Re=Dl(),{WEBCONFIG:R}=Ve(Re),y=d(U.params.drama_id),E=d(U.params.episode_id),Ae=Ie,se=d({}),Le=()=>{y.value&&x.get("/app/shortplay/api/Works/details",{params:{id:y.value}}).then(a=>{a.code===S.SUCCESS?(se.value=a.data,Ae("update:drama",se.value)):f.error(a.msg)}).catch(()=>{f.error("获取短剧详情失败")})},m=we({type:"episode",name:"",actor_id:"",species_type:null,gender:null,age:null,drama_id:y.value,episode_id:E.value}),k=d([]),ne=d(!1),A=d(null),p=d(),r=d({actor_id:"",drama_id:y.value,episode_id:E.value,name:"",species_type:null,gender:null,age:null,remarks:"",image_model_id:null,three_view_model_id:null,image_state:!1,three_view_image_state:!1,image_reference_state:!1,reference_headimg:"",image:"",three_view_image:""});gl(k,()=>{try{const a=k.value.find(e=>e.id===p.value?.id);if(a)J(a);else{const e=k.value.find(v=>v.is_edit);e?J(e):(p.value=void 0,r.value={id:"",drama_id:y.value,episode_id:E.value,name:"",species_type:null,gender:null,age:null,remarks:"",image_model_id:null,three_view_model_id:null,image_state:!1,three_view_image_state:!1,image_reference_state:!1,reference_headimg:"",image:"",three_view_image:""})}}catch(a){console.error("watch actorList error",a)}});const h=()=>{ne.value=!0,x.get("/app/shortplay/api/Actor/index",{params:m}).then(a=>{a.code===S.SUCCESS&&(k.value=a.data)}).catch(a=>{console.error("getActorList error",a)}).finally(()=>{ne.value=!1})},re=d(!1),$e=d([]),q=d([]),ie=d(!1),de=we({alias_id:"",scene:"actor_image",page:1,page_size:100});let N=null;const Fe=()=>{N&&N.abort(),N=new AbortController,ie.value=!0,q.value=[],x.get("/app/model/api/Task/index",{params:de,signal:N?.signal}).then(a=>{a.code===S.SUCCESS&&(q.value=a.data.data)}).finally(()=>{ie.value=!1})},J=a=>{a.is_edit&&(p.value=a,r.value.id=a.id,r.value.name=a.name,r.value.species_type=a.species_type,r.value.gender=a.gender,r.value.age=a.age,r.value.remarks=a.remarks,r.value.image=a.headimg,r.value.three_view_image=a.three_view_image,r.value.image_reference_state=!1,r.value.reference_headimg="",de.alias_id=a.id,Fe())},ue=d(null),ce=d(null),b=d({}),Y=a=>{a?(b.value=a,r.value.image_state=!0):(b.value={},r.value.image_model_id=null,r.value.image_state=!1),ue.value?.hide()},pe=d(null),_e=d(null),w=d({}),K=a=>{a?(w.value=a,r.value.three_view_image_state=!0):(w.value={},r.value.three_view_model_id=null,r.value.three_view_image_state=!1),pe.value?.hide()},Pe=Ce([b,w]),T=d(!1),Be=()=>{if(!(T.value||p.value.status_enum.value==="pending")){if(!r.value.image_model_id&&!r.value.three_view_model_id){f.error("请先选择形象图模型或三视图模型");return}T.value=!0,x.post("/app/shortplay/api/Actor/initializing",{...r.value,image:"",three_view_image:""}).then(a=>{a.code===S.SUCCESS?(p.value.status=a.data.status,p.value.status_enum=a.data.status_enum):f.error(a.msg)}).catch(()=>{f.error("生成图片失败")}).finally(()=>{T.value=!1})}},Q=d(null),L=d(!1),De=a=>{L.value=!1,a.code===S.SUCCESS?(r.value.image_reference_state=!0,r.value.reference_headimg=a.data.url):f.error(a.msg),Q.value?.clearFiles()},Me=()=>{L.value=!1,Q.value?.clearFiles()},O=d(!1),Ge=a=>{O.value||(O.value=!0,x.post("/app/shortplay/api/Actor/ReplaceActor",{id:p.value.id,task_id:a.id}).then(e=>{e.code===S.SUCCESS?(p.value.headimg=a.result.image_path,p.value.character_look_id||(p.value.origin_headimg=a.result.image_path),p.value.status=e.data.status,p.value.status_enum=e.data.status_enum,r.value.image=a.result.image_path):f.error(e.msg)}).catch(()=>{f.error("替换演员失败")}).finally(()=>{O.value=!1}))},$=d(!1),W=d(!1),me=d(0),X=d([]),qe=()=>{$.value=!0,X.value=k.value.filter(a=>a.status==="initializing"),me.value=X.value.length},Ne=Ce([b,w],me),Te=()=>{W.value=!0,Promise.all(X.value.map(a=>x.post("/app/shortplay/api/Actor/initializing",{id:a.id,image_reference_state:!!a.headimg,reference_headimg:a.headimg?a.headimg:"",image_state:!0,three_view_image_state:!0,image_model_id:b.value.id,three_view_model_id:w.value.id}))).then(()=>{h()}).catch(a=>{console.error("submitBatchGenerate error",a)}).finally(()=>{W.value=!1,$.value=!1})},Oe=a=>{x.post("/app/shortplay/api/DramaEpisode/deleteActor",{id:a.id,drama_id:y.value,episode_id:E.value}).then(e=>{e.code===S.SUCCESS?(f.success(e.msg),h()):f.error(e.msg)})},fe=d(),We=a=>{p.value=a,fe.value?.open({modelScene:"dialogue_voice",voice:a.voice})},je=a=>{x.post("/app/shortplay/api/Actor/voice",{id:p.value.id,drama_id:y.value,episode_id:E.value,apply_scope:"episode",voice:a}).then(e=>{e.code===S.SUCCESS?(f.success(e.msg),h()):f.error(e.msg)}).catch(e=>{console.error("handleVoiceSuccess error",e),f.error("设置演员音色失败")})},ge=d(),He=a=>{p.value=a,ge.value?.open?.({actor:a})},Je=a=>{let e="/app/shortplay/api/Generate/characterLook";a.type==="actor"&&(e="/app/shortplay/api/DramaEpisode/CharacterLook"),x.post(e,{drama_id:y.value,episode_id:E.value,actor_id:p.value.id,character_look_id:a.id,actor_costume_model_id:a.actor_costume_model_id,actor_costume_three_view_model_id:a.actor_costume_three_view_model_id}).then(v=>{if(v.code===S.SUCCESS){f.success(v.msg);const c=k.value.find(M=>M.id===v.data.id);a.type!="actor"&&c?c.character_look_state=1:h()}else f.error(v.msg)})},{subscribe:ve,unsubscribeAll:Ye}=Ol(),Ke=()=>{ve("private-generateactorimage-"+te.value?.user,a=>{console.log("channels complete info message",a);const e=k.value.find(v=>v.id===a.id);e&&(e.status_enum=a.status,a.image&&(e.headimg=a.image)),A.value?.subscribe?.("generateactorimage",a)}),ve("private-generateactorthreeviewimage-"+te.value?.user,a=>{console.log("channels complete info message",a);const e=k.value.find(v=>v.id===a.id);e&&(e.status_enum=a.status,a.image&&(e.three_view_image=a.image)),A.value?.subscribe?.("generateactorthreeviewimage",a)})},Qe=()=>{ze.push(`/generate/drama/${U.params.drama_id}/${U.params.episode_id}`)},Xe=()=>{ze.push(`/generate/props/${U.params.drama_id}/${U.params.episode_id}`)};return vl(()=>{h(),Le(),Ke()}),hl(()=>{console.log("actors unmounted"),Ye()}),(a,e)=>{const v=V("Search"),c=yl,M=kl,j=xl,F=wl,P=bl,Ze=Cl,he=V("Plus"),G=Sl,el=V("Delete"),ll=zl,al=V("UserFilled"),I=El,xe=Il,ke=V("Close"),ye=V("ArrowDown"),ol=V("PictureRounded"),Z=Ul,tl=Rl,sl=V("Top"),H=Pl,be=Al,nl=Fl,rl=pl,il=$l,dl=_l,ul=cl;return i(),u("div",Wl,[n("div",jl,[n("div",Hl,[t(Ze,{class:"flex flex-center grid-gap-4",onSubmit:D(h,["prevent"])},{default:s(()=>[t(j,{class:"mb-0"},{default:s(()=>[t(M,{modelValue:o(m).name,"onUpdate:modelValue":e[0]||(e[0]=l=>o(m).name=l),placeholder:"搜索演员",clearable:"",onChange:h},{suffix:s(()=>[t(c,null,{default:s(()=>[t(v)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e[20]||(e[20]=n("div",{class:"flex-1"},null,-1)),t(j,{class:"mb-0",style:{width:"80px"}},{default:s(()=>[t(P,{modelValue:o(m).species_type,"onUpdate:modelValue":e[1]||(e[1]=l=>o(m).species_type=l),placeholder:"物种",clearable:"",teleported:!1,onChange:h},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_species_type,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(j,{class:"mb-0",style:{width:"80px"}},{default:s(()=>[t(P,{modelValue:o(m).gender,"onUpdate:modelValue":e[2]||(e[2]=l=>o(m).gender=l),placeholder:"性别",clearable:"",teleported:!1,onChange:h},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_gender,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(j,{class:"mb-0",style:{width:"80px"}},{default:s(()=>[t(P,{modelValue:o(m).age,"onUpdate:modelValue":e[3]||(e[3]=l=>o(m).age=l),placeholder:"年龄",clearable:"",teleported:!1,onChange:h},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_age,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(xe,{class:"flex-1"},{default:s(()=>[n("div",Jl,[n("div",{class:"grid-column-1 rounded-4 p-4 actor-item flex flex-column flex-center grid-gap-4 pointer bg-overlay",onClick:e[4]||(e[4]=l=>o(A)?.open?.(null,o(m).drama_id,o(m).episode_id))},[t(c,{class:"rounded-4",size:"20",style:{height:"40px",width:"40px","background-color":"var(--el-fill-color-dark)"}},{default:s(()=>[t(he)]),_:1}),e[21]||(e[21]=n("span",null,"添加演员",-1))]),(i(!0),u(g,null,z(o(k),l=>(i(),u("div",{class:le(["grid-column-1 input-button rounded-4 flex flex-column flex-center grid-gap-2 actor-item bg-overlay border",{"border-success":l.id===o(r).id}]),key:l.id},[t(G,{src:l.headimg,class:"actor-avatar bg-mosaic",fit:"cover",title:l.is_edit?l.name:"公共角色不可编辑"},{default:s(()=>[ae(C(l.name),1)]),_:2},1032,["src","title"]),l.is_edit?(i(),u("div",{key:0,class:"actor-edit-mask flex flex-column grid-gap-4 flex-center pointer",onClick:B=>J(l)},[n("div",{class:"flex flex-center bg-overlay rounded-round p-2 pointer grid-gap-2",onClick:D(B=>o(A)?.upload?.(l,o(m).drama_id,o(m).episode_id),["stop"])},[t(c,{size:"16"},{default:s(()=>[t(o(Vl))]),_:1}),e[22]||(e[22]=n("span",{class:"h10"},"手动上传",-1))],8,Kl),t(ll,{title:"确定删除该演员吗？",width:"fit-content",onConfirm:B=>Oe(l),placement:"bottom-end"},{reference:s(()=>[n("div",{class:"flex flex-center bg-overlay rounded-round p-2 pointer grid-gap-2",onClick:e[5]||(e[5]=D(()=>{},["stop"]))},[t(c,{size:"16"},{default:s(()=>[t(el)]),_:1}),e[23]||(e[23]=n("span",{class:"h10"},"删除演员",-1))])]),_:1},8,["onConfirm"])],8,Yl)):ee("",!0),n("div",Ql,[e[24]||(e[24]=n("div",{class:"flex-1"},null,-1)),n("div",Xl,[n("span",{class:le(["actor-tag",["actor-tag--"+l.status_enum.props.type]])},C(l.status_enum.label),3)])]),n("div",Zl,[n("div",{class:le(["actor-name flex flex-center grid-gap-1",{pointer:l.is_edit,"actor-name--success":l.id===o(r).id}]),onClick:D(B=>o(A)?.open?.(l,o(m).drama_id,o(m).episode_id),["stop"])},[t(c,{size:"16"},{default:s(()=>[t(al)]),_:1}),n("span",null,C(l.name),1)],10,ea)]),n("div",la,[t(I,{text:"",bg:"",onClick:B=>We(l),class:"flex-1 text-ellipsis-1"},{default:s(()=>[l.voice?(i(),u("span",aa,"音色:"+C(l.voice.name),1)):(i(),u("span",oa,"演员音色"))]),_:2},1032,["onClick"]),t(I,{text:"",bg:"",onClick:B=>He(l),class:"flex-1 text-ellipsis-1",disabled:!!l.character_look_state},{default:s(()=>[l.character_look_state?(i(),u("span",ta,"换装中")):l.characterLook?(i(),u("span",sa,C(l.characterLook.title),1)):(i(),u("span",na,"演员装扮"))]),_:2},1032,["onClick","disabled"])])],2))),128))])]),_:1})]),n("div",ra,[o(r).id?(i(),u(g,{key:0},[n("div",ia,[t(M,{modelValue:o(r).name,"onUpdate:modelValue":e[6]||(e[6]=l=>o(r).name=l),placeholder:"角色演员",size:"large",class:"actor-form-input flex-1"},null,8,["modelValue"])]),n("div",da,[e[25]||(e[25]=n("span",null,"基础信息",-1)),n("div",ua,[t(P,{modelValue:o(r).species_type,"onUpdate:modelValue":e[7]||(e[7]=l=>o(r).species_type=l),placeholder:"请选择物种",size:"small",class:"flex-1 actor-form-select"},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_species_type,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(P,{modelValue:o(r).gender,"onUpdate:modelValue":e[8]||(e[8]=l=>o(r).gender=l),placeholder:"请选择性别",size:"small",class:"flex-1 actor-form-select"},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_gender,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(P,{modelValue:o(r).age,"onUpdate:modelValue":e[9]||(e[9]=l=>o(r).age=l),placeholder:"请选择年龄",size:"small",class:"flex-1 actor-form-select"},{default:s(()=>[(i(!0),u(g,null,z(o(R)?.enum?.actor_age,l=>(i(),_(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),n("div",ca,[e[29]||(e[29]=n("span",null,"角色描述",-1)),n("div",pa,[t(M,{modelValue:o(r).remarks,"onUpdate:modelValue":e[10]||(e[10]=l=>o(r).remarks=l),placeholder:"请输入角色描述",size:"small",class:"actor-form-textarea",type:"textarea",autosize:{minRows:6,maxRows:20}},null,8,["modelValue"]),n("div",_a,[n("div",{class:"bg-overlay rounded-round p-3 flex flex-center grid-gap-2 pointer hover-bg-hover",ref_key:"modelButtonRef",ref:ce,title:"选择使用AI生成形象图"},[o(b).id?(i(),u(g,{key:0},[t(G,{src:o(b).icon,alt:o(b).name,shape:"square",size:16},null,8,["src","alt"]),n("span",ma,C(o(b).name),1),t(c,{size:"16",class:"pointer",onClick:e[11]||(e[11]=D(l=>Y(),["stop"]))},{default:s(()=>[t(ke)]),_:1})],64)):(i(),u(g,{key:1},[t(c,{size:"16"},{default:s(()=>[t(Se)]),_:1}),e[26]||(e[26]=n("span",{class:"h10"},"形象图",-1)),t(c,{size:"16"},{default:s(()=>[t(ye)]),_:1})],64))],512),n("div",{class:"bg-overlay rounded-round p-3 flex flex-center grid-gap-2 pointer hover-bg-hover",ref_key:"threeViewModelButtonRef",ref:_e,title:"选择使用AI生成三视图"},[o(w).id?(i(),u(g,{key:0},[t(G,{src:o(w).icon,alt:o(w).name,shape:"square",size:16},null,8,["src","alt"]),n("span",fa,C(o(w).name),1),t(c,{size:"16",class:"pointer",onClick:e[12]||(e[12]=D(l=>K(),["stop"]))},{default:s(()=>[t(ke)]),_:1})],64)):(i(),u(g,{key:1},[t(c,{size:"16"},{default:s(()=>[t(Se)]),_:1}),e[27]||(e[27]=n("span",{class:"h10"},"三视图",-1)),t(c,{size:"16"},{default:s(()=>[t(ye)]),_:1})],64))],512),t(tl,{ref_key:"uploadImageRef",ref:Q,title:"添加参考图",data:{dir_name:"actor/reference",dir_title:"演员形象参考照片"},action:o(x).getCompleteUrl("app/shortplay/api/Uploads/upload"),headers:o(x).getHeaders(),accept:"image/jpeg,image/png",limit:1,type:"cover",disabled:o(L),"before-upload":()=>(L.value=!0,!0),"on-success":De,"show-file-list":!1,"on-error":Me},{default:s(()=>[n("div",ga,[t(Z,{placement:"top",disabled:!o(r).reference_headimg,width:"fit-content"},{reference:s(()=>[!o(r).reference_headimg||o(L)?(i(),_(c,{key:0,size:"16"},{default:s(()=>[o(L)?(i(),_(o(oe),{key:0,class:"circular"})):(i(),_(he,{key:1}))]),_:1})):(i(),_(c,{key:1,size:"16",color:"var(--el-color-success)"},{default:s(()=>[t(ol)]),_:1}))]),default:s(()=>[t(G,{src:o(r).reference_headimg,fit:"contain",size:130,shape:"square"},null,8,["src"])]),_:1},8,["disabled"])])]),_:1},8,["action","headers","disabled","before-upload"]),e[28]||(e[28]=n("div",{class:"flex-1"},null,-1)),n("div",va,[t(c,{size:"16"},{default:s(()=>[t(Ee)]),_:1}),n("span",ha,C(o(Pe)),1)]),n("div",{class:"rounded-round p-3 flex flex-center grid-gap-2 pointer",style:{"background-color":"#FFFFFF",color:"#141414"},onClick:Be},[t(c,{size:"20"},{default:s(()=>[o(T)||o(p).status_enum.value==="pending"?(i(),_(o(oe),{key:0,class:"circular"})):(i(),_(sl,{key:1}))]),_:1})])])])]),t(Z,{ref_key:"modelPopoverRef",ref:ue,"popper-class":"model-popover","virtual-ref":o(ce),"virtual-triggering":"",placement:"bottom",width:"min(100vw,380px)",trigger:"click"},{default:s(()=>[t(H,{modelValue:o(r).image_model_id,"onUpdate:modelValue":e[13]||(e[13]=l=>o(r).image_model_id=l),onSelect:Y,"no-init":"",scene:"actor_image"},null,8,["modelValue"])]),_:1},8,["virtual-ref"]),t(Z,{ref_key:"threeViewModelPopoverRef",ref:pe,"popper-class":"model-popover","virtual-ref":o(_e),"virtual-triggering":"",placement:"bottom",width:"min(100vw,380px)",trigger:"click"},{default:s(()=>[t(H,{modelValue:o(r).three_view_model_id,"onUpdate:modelValue":e[14]||(e[14]=l=>o(r).three_view_model_id=l),onSelect:K,"no-init":"",scene:"actor_three_view_image"},null,8,["modelValue"])]),_:1},8,["virtual-ref"]),e[31]||(e[31]=n("div",{class:"flex flex-column grid-gap-2 px-4 pt-4"},[n("span",null,"角色原始形象记录")],-1)),t(xe,{class:"flex-1"},{default:s(()=>[o(q).length>0?(i(),u("div",xa,[(i(!0),u(g,null,z(o(q),l=>(i(),u("div",{class:"grid-column-1 task-item",key:l.id},[t(G,{src:l.result.image_path,fit:"contain",shape:"square",size:206},null,8,["src"]),l.status==="success"&&l.result.image_path!==o(p).headimg&&l.result.image_path!==o(p).origin_headimg?(i(),u("div",{key:0,class:"flex flex-center grid-gap-2 task-item-replace pointer",onClick:B=>Ge(l)},[t(c,null,{default:s(()=>[o(O)?(i(),_(o(oe),{key:0,class:"circular"})):(i(),_(Tl,{key:1}))]),_:1}),e[30]||(e[30]=n("span",{class:"h10 text-nowrap"},"替换原始形象",-1))],8,ka)):ee("",!0)]))),128))])):(i(),_(be,{key:1,description:"暂无原始形象记录"}))]),_:1})],64)):(i(),_(be,{key:1,description:"点击角色名称选择角色"}))])]),n("div",ya,[t(I,{bg:"",text:"",size:"large",onClick:Qe},{default:s(()=>[t(c,{size:"16"},{default:s(()=>[t(Gl)]),_:1}),e[32]||(e[32]=n("span",null,"上一步",-1))]),_:1}),t(I,{type:"success",size:"large",disabled:o(k).filter(l=>l.status==="initializing").length<=0,onClick:qe},{default:s(()=>[t(c,{size:"16"},{default:s(()=>[t(Nl)]),_:1}),e[33]||(e[33]=n("span",null,"批量生成",-1))]),_:1},8,["disabled"]),t(I,{type:"success",size:"large",onClick:Xe},{default:s(()=>[e[34]||(e[34]=n("span",null,"下一步",-1)),t(c,{size:"16",class:"ml-2"},{default:s(()=>[t(ql)]),_:1})]),_:1})]),o(re)?(i(),_(nl,{key:0,"url-list":o($e),onClose:e[15]||(e[15]=l=>re.value=!1)},null,8,["url-list"])):ee("",!0),t(rl,{ref_key:"actorCreateRef",ref:A,onSuccess:h},null,512),t(il,{modelValue:o($),"onUpdate:modelValue":e[19]||(e[19]=l=>Ll($)?$.value=l:null),class:"generate-storyboard-dialog",draggable:"",width:"800px"},{header:s(()=>[...e[35]||(e[35]=[n("span",{class:"font-weight-600"},"批量生成演员",-1)])]),footer:s(()=>[t(I,{type:"info",onClick:e[18]||(e[18]=l=>$.value=!1),disabled:o(W)},{default:s(()=>[...e[36]||(e[36]=[ae("取消",-1)])]),_:1},8,["disabled"]),e[38]||(e[38]=n("div",{class:"flex-1"},null,-1)),n("div",wa,[t(c,{size:"16"},{default:s(()=>[t(Ee)]),_:1}),n("span",Ca,C(o(Ne)),1)]),t(I,{type:"success",icon:"Check",onClick:Te,disabled:!o(r).image_model_id||!o(r).three_view_model_id,loading:o(W)},{default:s(()=>[...e[37]||(e[37]=[ae("生成",-1)])]),_:1},8,["disabled","loading"])]),default:s(()=>[n("div",ba,[t(H,{title:"形象模型",modelValue:o(r).image_model_id,"onUpdate:modelValue":e[16]||(e[16]=l=>o(r).image_model_id=l),onSelect:Y,"no-init":"",class:"flex-1 bg-overlay rounded-4 p-4",scene:"actor_image"},null,8,["modelValue"]),t(H,{title:"三视图模型",modelValue:o(r).three_view_model_id,"onUpdate:modelValue":e[17]||(e[17]=l=>o(r).three_view_model_id=l),onSelect:K,class:"flex-1 bg-overlay rounded-4 p-4","no-init":"",scene:"actor_three_view_image"},null,8,["modelValue"])])]),_:1},8,["modelValue"]),t(dl,{ref_key:"voiceDialogRef",ref:fe,onSuccess:je},null,512),t(ul,{ref_key:"characterLookRef",ref:ge,onSelect:Je,query:{drama_id:o(y),episode_id:o(E)}},null,8,["query"])])}}}),Ma=Ml(Sa,[["__scopeId","data-v-f03b755e"]]);export{Ma as default};
